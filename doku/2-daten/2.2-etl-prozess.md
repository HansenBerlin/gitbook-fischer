# 2.2 ETL Prozess

Fokus: Transform (Filterung, Harmonisierung, Aggregation, Anreicherung) und kurz Load (eigene API, ohne Code, den dann im Anhang)

## immoscout\_rent.csv

### Extract

https://www.kaggle.com/datasets/corrieaar/apartment-rental-offers-in-germany Datensatz: immo\_data.csv

in Produktion aus echter Bestandsdatenbank des Unternehmens

### Transform

#### Filterung

Mängel 1. / 2. Klasse:

* wenn eine der Spalten totalRent, serviceCharge, baseRent leer ist, dann aus den Werten der anderen Spalten berechnet
* Zeilen mit Nullwerten in wichtigen Spalten entfernen
* Nullwerte in diversen Spalten mit mean / median Wert auffüllen

Entfernung von Ausreißern abs 3% nach unten und oben:

* pricetrend
* totalRent
* serviceCharge
* baseRent
* livingSpace
* noRooms
* telekomUploadSpeed
* yearConstructed
* noParkSpaces

_was wurde noch rausgeschmissen?_

#### Harmonisierung

für alle Spalten mit Wahrheitswerten true mit 1 und false mit 0 ersetzen

#### Aggregation

Spalten entfernen: regio1, telekomTvOffer, telekomHybridUploadSpeed, newlyConst, picturecount, scoutId, geo\_bln, yearConstructedRange, houseNumber, geo\_krs, petsAllowed, street, streetPlain, baseRentRange, geo\_plz, thermalChar, numberOfFloors, noRoomsRange, livingSpaceRange, regio2, regio3, description, facilities, heatingCosts, energyEfficiencyClass, lastRefurbish, electricityBasePrice, electricityKwhPrice, date

#### Anreicherung

Spalten hinzugefügt:

* longitude
* latitude
* qmPriceInEuroTotalRent = totalRent / livingSpace
* qmPriceInEuroServiceCharge = serviceCharge / livingSpace
* qmPriceInEuroBaseRent = baseRent / livingSpace
* long- und latitude mithilfe der Spalten via openstreatsmap abrufen und dann die Spalten entfernen
* Spalten: streetPlain, houseNumber, geo\_plz, regio2, regio1
* Hinzufügen einer eindeutigen fortlaufenden ID+

**m^2PreisinEuroWarm gleiche für kalt und nebenkosten**

### Load

Speichern als immoscout\_rent.csv

## immo\_data\_houses.csv

### Extract

https://www.kaggle.com/datasets/phanindraparashar/germany-housing-rent-and-price-data-set-apr-20 Datensatz: apr20\_price\_33\_col.csv

in Produktion über Immoscout API

rest ähnlich wie immo\_data.csv

## Breitbandversorgung&#x20;

### Extract

Datenabzug aus operativen Quellsystemen, i.d.R. automatisiert über Schnittstellen

von Regional Datenbank(https://www.regionalstatistik.de/genesis/online/logon) Datensätze: Tabelle Abfrage1 (2).csv

### Transform

#### Filterung

Mängel 1. Klasse

* 'Breitbandversorgung mit 50 Mbit/s in %' = "." entfernen und "," mit "." ersetzten
* 'Breitbandversorgung mit 100 Mbit/s in %' = "." entfernen und "," mit "." ersetzten
* 'Breitbandversorgung mit 1000 Mbit/s in %' = "." entfernen und "," mit "." ersetzten

_was wurde noch rausgeschmissen?_

#### Harmonisierung

umbenennen der Spalten:

* 'Breitbandversorgung mit 50 Mbit/s in %': 'breitbandversorgung50MbitsProzent'
* 'Breitbandversorgung mit 100 Mbit/s in %': 'breitbandversorgung100MbitsProzent'
* 'Breitbandversorgung mit 1000 Mbit/s in %': 'breitbandversorgung1000MbitsProzent'

#### Aggregation

Spalten entfernen: Raumeinheit, Aggregat, 'Breitbandversorgung mit 16 Mbit/s in %'

#### Anreicherung

### Load

Speicherung als: breitbandversorgung20.csv

## bau\_einkommen\_insolvenz&#x20;

### Extract

Datenabzug aus operativen Quellsystemen, i.d.R. automatisiert über Schnittstellen

von Regional Datenbank (https://www.regionalstatistik.de/genesis/online/logon) Datensätze:

* Tabelle Abfrage1.csv
* Tabelle Abfrage1 (1).csv

### Transform

#### Filterung

für "Tabelle Abfrage1 (1).csv" Mängel 1. Klasse:

* Raumeinheit = von mehreren durch Komma getrennte Städtenamen nur den ersten behalten
* Baugenehmigungen für Wohnungen = "." entfernen und "," mit "." ersetzten
* Verbraucherinsolvenzverfahren = "." entfernen und "," mit "." ersetzten

für "Tabelle Abfrage1.csv" Mängel 1. Klasse:

* Raumeinheit = von mehreren durch Komma getrennte Städtenamen nur den ersten behalten
* Haushaltseinkommen = "." entfernen und "," mit "." ersetzten
* Baulandpreise = "." entfernen und "," mit "." ersetzten

#### Harmonisierung

für "Tabelle Abfrage1 (1).csv" Spalten umbenennen:

* 'Kennziffer': 'ags'
* 'Baugenehmigungen für Wohnungen': 'baugenehmigungenWohnungen'
* 'Baulandpreise': 'baulandpreise'

für "Tabelle Abfrage1.csv" Spalten umbenennen:

* 'Kennziffer': 'ags'
* 'Haushaltseinkommen': 'haushaltseinkommen\_19'
* 'Verbraucherinsolvenzverfahren': 'verbraucherinsolvenzverfahren'

#### Aggregation

für "Tabelle Abfrage1 (1).csv" Spalten entfernen: Raumeinheit, Aggregate

für "Tabelle Abfrage1.csv" Spalten entfernen: Arbeitsvolumen, Raumeinheit, Aggregate

#### Anreicherung

bei Datensätze über den Spalte "ags" mergen (outer) für die Spalten "baugenehmigungenWohnungen" und "baulandpreise" Nullwerte mit den Durchschnittswerten der Spalten füllen

### Load

Speichern als: merged\_bau\_einkommen\_insolvenz.csv
